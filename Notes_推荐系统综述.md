# Notes:推荐系统综述

### 推荐系统

个性化推荐系统主要分为两个阶段，**召回阶段和排序阶段。**

![1556811826212](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1556811826212.png)

从千万量级的候选物品里，采取简单模型将推荐物品候选集合快速筛减千级别甚至百级别，这样将候选集合数量降下来，之后在排序阶段就可以上一些复杂模型，细致地对候选集进行个性化排序。

##### why1：为什么主流的推荐系统要分成两个阶段？

召回阶段采用多路召回，每一路召回因为采取的策略或者模型不同，所以各自的召回模型得分不可比较，比如利用协同过滤召回找到的候选Item得分，与基于兴趣标签这一路召回找到的候选Item得分，完全是不可比较的。这就是为何要用第二阶段排序来将分数统一的原因。

###### **隐患（多路召回分数不可比）**

多路召回分数不可比，我们可以依靠排序阶段来让它们可比即可。但是多路召回分数不可比会引发**更棘手的问题**：对于每一路召回，我们应该返回多少个Item是合适的呢？如果在多路召回模式下，这个问题就很难解决。既然分数不可比，那么每一路召回多少候选项K就成为了超参，需要不断调整这个参数上线做AB测试，才能找到合适的数值。这样的超参组合空间是非常大的。所以到底哪一组超参是最优的，就很难定。其实现实情况中，很多时候这个超参(Item个数)都是拍脑袋上线测试，如：基于兴趣标签召回1000个候选集，协同过滤召回3000个候选集。为什么是1000个和3000个?就是拍脑袋的。因此找到最优的超参组合概率是很低的。

##### why2：是否存在一个模型把传统的两阶段召回阶段和排序阶段一步到位做完？

统一用FM模型来做召回，那么它们在召回阶段的得分是完全可比的。可以认为各路召回的这组超参数就完全依靠FM模型调整成个性化。比如有的用户喜欢看热门的内容，那么热门内容在召回阶段返回的比例就高，而其它内容返回比例就低。

### 召回阶段

召回阶段因为需要计算的候选集合太大，所以要想速度快，就只能
1、上简单模型
2、使用少量特征
以保证泛化能力，尽量让用户感兴趣的物品在这个阶段能够找回来

目前工业界推荐系统在召回阶段，大多数采用了多路召回策略，比如典型的召回路有：基于用户兴趣标签的召回；基于协同过滤的召回；基于热门的召回；基于主题模型的召回；基于实体分类召回；基于上下文联系等等

![1556811780141](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1556811780141.png)

对于每一路召回，会拉回K条相关Item，这个K值是个超参，需要通过线上AB测试来确定合理的取值范围。会发现这里有个潜在的问题(即之前提过的隐患)，如果召回路数太多，对应的超参就多，这些超参组合空间很大，如何设定合理的各路召回数量是个问题。另外，如果是多路召回，这个超参往往不太可能是用户个性化的，而是对于所有用户，每一路拉回的数量都是固定的，这里明显有优化空间。

### 排序阶段

排序阶段核心目标是要精准，它处理的物品数据量小，因此
1.采用尽可能多的特征
2.使用比较复杂的模型
一切以精准为目标。

这个排序可理解为一个函数，![F(user, item, context)](https://math.jianshu.com/math?formula=F(user%2C%20item%2C%20context))，输入为用户、物品、环境，输出一个0到1之间的分数，取分数最高的TOP。这一过程通常称为CTR预估。

排序阶段常用模型：LR、GBDT+LR、FM、FFM、FNN